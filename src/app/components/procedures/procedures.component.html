<div class="container procedures_container">
  <div class="page_block procedures_head">
    <div class="procedure_inputs">
      <input class="form-control input-sm procedure_name" type="text" placeholder="Folder Name">

      <select class="form-control input-sm procedure_type"></select>
      <select [(ngModel)]="selectedLanguage" (ngModelChange)="languageChange($event)" class="form-control input-sm language">
        <option *ngFor="let lang of languageList; let i = index" [value]="lang?.code">{{lang?.name}}</option>
      </select>

      <div style="float:left; margin-top: 5px; padding-left: 5px;" class="checkbox">
        <label style="font-size: 11px;">
          <input value="true" [checked]="" style="margin-top: 2px;" type="checkbox" value="">Show as separate icons in app</label>
      </div>
    </div>
    <div class="procedure_btns">
      <button (click)="newFolder($event)" class="ili-btn procedure_new">
        New
      </button>
      <button (click)="saveProcedure($event, true)" class="ili-btn btn procedure_save">
        Save
      </button>
      <button (click)="duplicateProcedure($event, true)" class="ili-btn procedure_duplicate">
        Duplicate
      </button>
      <button (click)="deleteProcedure($event)" class="ili-btn procedure_delete">
        Delete
      </button>
      <button class="ili-btn page_setup">
        Page Setup
      </button>
      <button class="ili-btn default_page_setup">
        Default Page Setup
      </button>
    </div>
  </div>
  <div class="procedure_main_content">
    <div class="page_block procedures_block">
      <div class="procedure_text">
        <span> PROCEDURES </span>
      </div>
      <input [(ngModel)]="procedureFilter['procedureSearch']" class="form-control input-sm search_box_procedure" type="text" placeholder="Search Procedures">

      <select [ngModel]="procedureFilter['procedureCategory']['_id']" (ngModelChange)="filterChange($event, 'procedureCategory')"
        class="form-control input-sm filter_procedure">
        <option [value]="-1">Show All Types</option>
        <option *ngFor="let procCat of (procedureCategories | orderBy: true : 'name'); let i = index" [value]="procCat?._id">{{procCat?.name}}</option>
      </select>
      <select [ngModel]="procedureFilter['sort']['selected']" (ngModelChange)="filterChange($event, 'sort')" class="form-control input-sm filter_procedure">
        <option [value]="'date_desc'">Latest on top</option>
        <option [value]="'date_asc'">Oldest on top</option>
        <option [value]="'name_asc'">Name - A on top</option>
        <option [value]="'name_desc'">Name - Z on top</option>
        <option [value]="'type_asc'">Type - A on top</option>
        <option [value]="'type_desc'">Type - Z on top</option>
      </select>

      <div id="main-container-procedures" class="procedure_list_show">
        <div [ngClass]="procedure.hasOwnProperty('obj') && proc?._id === procedure.obj?._id ? 'procedure_list_single selected' : 'procedure_list_single'"
          (click)="selectProcedure($event, proc)" *ngFor="let proc of (procedures | filterByText:'name':procedureFilter['procedureSearch'] | filterByText:procedureFilter['procedureCategory']['fieldName']:procedureFilter['procedureCategory']['_id'] | orderBy:procedureFilter['sort']['isAsc']: procedureFilter['sort']['fieldNames'][splitKey(procedureFilter['sort']['selected'])][0]: procedureFilter['sort']['fieldNames'][splitKey(procedureFilter['sort']['selected'])][1]); let i = index; trackBy: trackByIndex">
          {{procedureNotificationIcon(proc)}}
          <div [title]="proc?.name" class="procedure_list_title">{{proc?.name}}</div>
          <div class="procedure-notify-icons">
            <span [title]="proc?.tileNotifications" class='step smart noteicon smarticon-groups' [style.display]="proc?.tileNotifications ? 'block' : 'none'"
              aria-hidden="true">
              <i class='icon ion-android-notifications-none'></i>
            </span>
            <span [title]="proc?.tileSmart" [style.display]="proc?.tileSmart ? 'block' : 'none'" class="step smart smarticon smarticon-groups">
              <i class="icon ion-lightbulb"></i>
            </span>
            <span [title]="proc?.pageApps" [style.display]="proc['isRole']?'block' : 'none'" class="step smart smarticon smarticon-groups">
              <i class="icon ion-android-person"></i>
            </span>
          </div>
        </div>
      </div>
    </div>

    <div id="dragged-procedure-tiles" class="page_block main_procedure_container">
      <div iliDropTarget (myDrop)="onDrop($event, false)" class="ili-panel main_procedure_content drop_target">
        <div class="draggable_label">To add Tiles to this Event, simply drag them in this space.
          <br>
          <br>To add the Tiles to this Event, simply drag them in this space.
          <br>
          <br>Add Tiles in order you want them to appear in the app.</div>
      </div>

      <div *ngFor="let dragTile of procedure!.draggedTiles | reverse; let i = index; trackBy: trackByUniqueId" class="ili-panel procedure_content">
        {{ setDragIndex(i, dragTile)}}
        <div *ngIf="!dragTile.hasOwnProperty('procedureDragContainer')" class="procedure_main_panel">
         <div class="tile-title-drag-btns">
           <div class="top-tile-title">
              <label class="procedure_tile_title"> {{dragTile?.tile?.title}} </label>
           </div>
          <div class="drag_buttons">
            <button (click)="addDraggable(i)" class="trigger_btn" title="Add Space">
              <span class="glyphicon glyphicon-plus"></span>
            </button>
            <button (click)="replicateTile(dragTile)" class="trigger_btn" title="Replicate">
              <span class="glyphicon glyphicon-retweet"></span>
            </button>
            <button (click)="moveUpDown('up', i)" class="trigger_btn" title="MoveUp">
              <span class="glyphicon glyphicon-arrow-up"></span>
            </button>
            <button (click)="moveUpDown('down', i)" class="trigger_btn" title="MoveDown">
              <span class="glyphicon glyphicon-arrow-down"></span>
            </button>
            <button (click)="deleteDraggedTile(i)" class="trigger_btn" title="Remove">
              <span class="glyphicon glyphicon-remove"></span>
            </button>
          </div>
         </div>
        </div>
        <div iliDropTarget (myDrop)="onDrop($event, true)" *ngIf="dragTile.hasOwnProperty('procedureDragContainer')" class="draggable_label drop_target">
          To add Tiles to this Event, simply drag them in this space.
          <br>
          <br>To add the Tiles to this Event, simply drag them in this space.
          <br>
          <br>Add Tiles in order you want them to appear in the app.
        </div>
      </div>
    </div>

    <tiles-list class="dragItem" (tileContent)="getTileContent($event)" [tilesToUpdate]="tilesToUpdate" [isMerge]="isMerge" [draggedTiles]="draggedTiles"
      [droppedTile]="droppedTile" [organizations]="organizations" [page]="'procedures'"></tiles-list>
  </div>
</div>